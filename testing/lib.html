<!DOCTYPE html>
<html lang="en">

<head>
    <title>Library</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Visual library test (not js library) with json">
    <meta name="author" content="bestGaming132">
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../default.css">
    <link rel="stylesheet" href="../scroll.css">
</head>

<body align="center">
    <h2>Library</h2>
    <table id="t">
        <tbody id="tb">
        </tbody>
    </table>
</body>
<script>
    //useful functions
    function log(str) {
        console.log(str);
    }

    function elm(id) {
        return document.getElementById(id);
    }

    //start
    function genJson(length = 10) {
        let output = ""
        for (i = 0; i < length; i++) {
            output += '{"title": "Title' + i + '","desc":"Lorem ipsum dolor sit amet","img": "https://bestgaming1320.github.io/placeholder.png"},'
        }
        return "[" + output.slice(0, -1) + "]"
    }

    function p(txt,tit) {
        let p = document.createElement("p")
        p.innerHTML = txt
        if (tit) p.classList.add("t")
        return p
    }
    function img(url) {
        let img = document.createElement("img")
        img.src = url
        return img
    }
    var sw
    if (screen.width <= 350) sw = 1
    else if (screen.width <= 500) sw = 2
    else if (screen.width <= 700) sw = 3
    else sw = 4
    function genLib(input = defJson) {
        var tb = elm("tb")
        var tr = document.createElement("tr")
        for (i = 1; i < input.length + 1; i++) {
            let td = document.createElement("td")
            let div = document.createElement("div")
            div.appendChild(p(input[i - 1].title, 1))
            div.appendChild(img(input[i - 1].img))
            div.appendChild(p(input[i - 1].desc))
            div.classList.add("nobar")
            td.appendChild(div)
            tr.appendChild(td)

            if (i % sw == 0 || i == input.length) {
                tb.appendChild(tr)
                tr = document.createElement("tr")
            }
        }
    }
    let ce = location.search.slice(1)
    ce = ce ? ce : 17
    let json = parseInt(ce) ? genJson(ce) : decodeURIComponent(ce)
    genLib(JSON.parse(json))
</script>
<style>
    table {
        margin: 0 auto
    }

    div {
        width: 17vw;
        min-width: 160px;
        height: 15vh;
        min-height: 260px;
        border: 2px solid #999;
        overflow-y: scroll
    }

    .t {
        font-size: 22px;
        font-weight: 700
    }

    img {
        width: 60%
    }

    p {
        font-size: 16px
    }
</style>
</html>
